---
# Soupkitchen kwalify schema

type: map
mapping:

  "nodes":
    type: seq
    sequence:
      -
        type: map
        mapping:
          "name": { required: true }
          "address": { required: false }

          "boxname": &boxname
            type: str
          "boxurl": &boxurl
            type: str
          "role":
            desc: "A node can have a role, that adds specific configuration for how it is going to be used."
            type: str
            enum: ["master", "console", "agent"]
            default: "agent"

          "profile":
            desc: "A node can have a profile, which describes where the box came from."
            type: str
          "forwards": &forwards
            type: seq
            sequence:
              -
                type: map
                mapping:
                  "source":
                    type: int
                    required: true
                  "dest":
                    type: int
                    required: true
          "postinstall": &postinstall
            desc: "The path to an optional script to run as the final provisioning action."
            type: str
            required: false

  "profiles":
    desc: "A profile describes a box type, so what name it is and where to retrieve it from."
    type: seq
    sequence:
      -
        type: map
        mapping:
          "name":
            required: true
          "boxname": *boxname
          "boxurl": *boxurl
          "postinstall": *postinstall


  "roles":
    desc: "A role is the configuration needed for a node to do a specific role."
    type: seq
    sequence:
      -
        type: map
        mapping:
          "name": { required: true }
          "forwards": *forwards
          "postinstall": *postinstall

  # Network configuration for soupkitchen, not applicable to any node.
  "networking":
    type: map
    mapping:
      "start":
        default: '10.16.1.4'
      "end":
        default: '10.16.1.31'

